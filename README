SSL Requirement
===============

SSL requirement adds a declarative way of specifying that certain actions
should only be allowed to run under SSL, and if they're accessed without it,
they should be redirected.

Example:

  class ApplicationController < ActionController::Base
    include SslRequirement
  end

  class AccountController < ApplicationController
    ssl_required :signup, :payment 
    ssl_allowed :index
    
    def signup
      # Non-SSL access will be redirected to SSL
    end
    
    def payment
      # Non-SSL access will be redirected to SSL
    end

    def index
      # This action will work either with or without SSL
    end

    def other
      # SSL access will be redirected to non-SSL
    end
  end
  
If a majority (or all) of your actions require SSL, then use ssl_exceptions instead of ssl_required.
You can list out the actions that you do NOT want to be SSL protected. Calling ssl_exceptions without 
any actions listed will make ALL actions SSL protected. 
 
You can overwrite the protected method ssl_required? to rely on other things
than just the declarative specification. Say, only premium accounts get SSL.

For SSL domains that differ from the domain of the redirecting site, add the 
following code to development.rb / test.rb / production.rb:

# Redirects to https://secure.example.com instead of the default 
# https://www.example.com.
config.after_initialize do
  SslRequirement.ssl_host = 'secure.example.com'
end

You are able to turn disable ssl redirects by adding the following environment configuration file:
  SslRequirement.disable_ssl_check = true
  
This plugin also adds a helper called secure_for_tag. The syntax is exactly the same as form_tag except
it will post to the https version of the url if SslRequirement.disable_ssl_check? returns false. Here is
an example:

<% secure_form_tag session_path, :class => 'home_login' do -%>
  <p>
    <label for="name">Email</label>
    <%= text_field_tag 'email', '', :class => 'text', :tabindex => 1 %>
  </p>
  <p>
    <label for="password">Password</label>
    <%= password_field_tag 'password', '', :class => 'text', :tabindex => 2 %>
  </p>
  <p>
    <%= submit_tag "Login", :id => 'login_submit', :value => "", :alt => "Login" %>
  </p>
<% end -%>

P.S.: Beware when you include the SslRequirement module. At the time of
inclusion, it'll add the before_filter that validates the declarations. Some
times you'll want to run other before_filters before that. They should then be
declared ahead of including this module.

Copyright (c) 2005 David Heinemeier Hansson, released under the MIT license
